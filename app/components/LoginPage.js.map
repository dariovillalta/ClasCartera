{"version":3,"sources":["components/LoginPage.js"],"names":["LoginPage","props","login","bind","username","$","val","password","localeCompare","length","transaction","sql","Transaction","pool","begin","err","rolledBack","on","aborted","request","Request","query","result","console","log","rollback","alert","commit","recordset","usuario","nombreCompleto","tipoUsuario","maxWidth","height","React","Component"],"mappings":"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","sourcesContent":["import React from 'react';\nimport sql from 'mssql';\n\nexport default class LoginPage extends React.Component {\n    constructor(props) {\n        super(props);\n        this.login = this.login.bind(this);\n    }\n\n    login () {\n        var username = $('#username').val();\n        var password = $('#password').val();\n        if(username.localeCompare(\"admin\") == 0) {\n            if(password.localeCompare(\"password111!\") == 0) {\n                this.props.login(\"Admin\", \"admin\");\n            }\n        }\n        if(username.length > 0){\n            if(password.length > 0){\n                const transaction = new sql.Transaction( this.props.pool );\n                transaction.begin(err => {\n                    var rolledBack = false;\n                    transaction.on('rollback', aborted => {\n                        // emited with aborted === true\n                        rolledBack = true;\n                    });\n                    const request = new sql.Request(transaction);\n                    request.query(\"select * from Usuarios where usuario = '\"+ username +\"' and contrasena = '\"+ password +\"'\", (err, result) => {\n                        if (err) {\n                            console.log(err);\n                            if (!rolledBack) {\n                                transaction.rollback(err => {\n                                    alert(\"Error en conección con la tabla de Usuarios.\");\n                                });\n                            }\n                        }  else {\n                            transaction.commit(err => {\n                                // ... error checks\n                                if(result.recordset.length > 0) {\n                                    var usuario = result.recordset[0];\n                                    //Cookie Username\n                                    this.props.login(usuario.nombreCompleto, usuario.tipoUsuario);\n                                } else {\n                                    alert(\"Usuario ó contraseña incorrecta.\");\n                                }\n                            });\n                        }\n                    });\n                }); // fin transaction\n            } else {\n                alert(\"Ingrese un valor para la contraseña.\");\n            }\n        } else {\n            alert(\"Ingrese un valor para el usuario.\");\n        }\n    }\n\n    render() {\n        return (\n            <div className=\"splash-container\">\n                <div className=\"card \">\n                    <div className=\"card-header text-center\">\n                        <img className=\"logo-img\" src=\"./assets/logoTOLOC.png\" alt=\"logo\" style={{maxWidth: \"100%\", height: \"auto\"}}/>\n                        <h1 className=\"display-4\">Clasificaci&oacute;n de Cartera</h1>\n                        <span className=\"splash-description\">Por favor ingrese su informaci&oacute;n de usuario.</span>\n                    </div>\n                    <div className=\"card-body\">\n                            <div className=\"form-group\">\n                                <input className=\"form-control form-control-lg\" id=\"username\" type=\"text\" placeholder=\"Usuario\"/>\n                            </div>\n                            <div className=\"form-group\">\n                                <input className=\"form-control form-control-lg\" id=\"password\" type=\"password\" placeholder=\"Contraseña\"/>\n                            </div>\n                            <button className=\"btn btn-primary btn-lg btn-block\" onClick={this.login}>Iniciar Sesi&oacute;n</button>\n                    </div>\n                </div>\n            </div>\n        );\n    }\n}\n"],"file":"LoginPage.js"}